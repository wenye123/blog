以我在美的实习时候做的项目为基础，总结的`Vue`架构设计

`PS: `当时我在美的负责的是内部系统---<<在线客服>>管理台的前端开发，在我之前这个项目不受重视，此前经过多次人手转换，代码很是混乱，但是给了我机会重构

## 目录结构设计

```bash
├─assets # 全局资源，比如全局样式(基础样式初始化，滚动条样式)
├─components # Vue组件存放目录
│  ├─Control # 控制台
│  ├─Public # 公共组件，比如导航栏组件，404组件
│  └─Work # 管理台
├─api # api接口地址
├─config # 配置文件，有通用模式(比如pageSize)，开发模式/生成模式(比如图片服务器地址)
├─locales # 语言包
├─router # 路由(控制台/管理台)
├─store # Vuex状态，有一些基础的功能，比如ajax封装成通用的action。采用命名空间连接管理台/控制台的状态
└─utils # 工具函数，比如根据时间字符串获取年月日
```

## 组件与状态管理

比如有这样一个页面

![页面拆分图](./pic/fw1.png)

它的目录结构如下所示

**一个页面拆分成三层**

```bash
主页面 # 第一层
├─上 # 第二层
│  ├─组件A # 这是第三层，这一层下如果组件还需要细分也不会再拆分成文件夹了，而是以.vue的形式
│  │  │  index.vue
│  │  │  left.vue # 假如left.vue还需要拆分成上下部分，我们会新增left_top.vue和left.bottom.vue
│  │  │  right.vue
│  │  └─assets # 组件A引用到的资源，比如图片字体，都是放在一起的
│  └─组件B
├─下
└─中
└─store # 每一个页面对应一个store，最后使用命名空间连接到根目录的store
```

**注意：**

**一个页面最多拆分为三层**: 例如上图的只拆分到组件A级别，如果组件A还需要继续拆分，也只会采用下划线`_`分割的命名方式来区分上下级关系，比如`left.vue`还需要拆分成上下部分，我们会新增`left_top.vue`和`left.bottom.vue`，依次类推

**assets**: 我们将组件中使用到的资源都是放在组件中的，比如组件A中用到的图片都是放在组件A目录下的assets文件夹中，而不是全局的assets目录中。这样做的好处就是方便了组件移植，假如另外一个页面也需要一个一模一样的组件A，我们就可以直接复制整个组件A文件夹过去即可。虽然会多打包一些资源的，按时由于资源大部分只是icon图标，所以还是可以接受的。

**store**： 每一个页面的状态都是放在页面文件夹的store文件夹中，再通过命名空间连接到根目录的store中，这是因为每个页面都要很多状态，如果都放在根目录的store中则会变得非常庞大，拆分成页面级别是比较适合这个项目的

## 样式管理

**全局样式**: 放在根目录的`assets`目录下，比如初始化样式，一些全局的共用混合，函数，变量，统一修改element样式。

**组件样式**:

```css
<style>
/* 
全局样式，比如修改element样式(写在scoped中的style将不会生效)
修改elemnent样式需要注意以下两点!!
1. 全局修改的就放在全局样式的assets下，可以使用element默认的css类去覆盖
2. 组件内部修改是给elementUI自定义一个custom class再修改(防止使用element默认类修改会影响到其他组件样式)
*/
</style>

<style scoped>
/* 本地样式, 使用bem + scoped(bem不是必需的) */
</style>
```

## 路由管理

- 分为控制台的路由和管理台的路由，最后拼接在一起
- 页面级别的使用异步组件，比如上图"主页面"那个组件

## ajax与接口统一管理

- 在`api`文件夹中定义好所有的`api`接口地址
- 在根store中封装好通用的`ajax action`，比如`get/post`方法，加载前后的loading，错误处理(比如token过期就跳到登录页面，报错就直接弹窗显示错误)
- 每个页面级别的接口请求都定义在当前页面中的store/action中(方便统一管理)，`action`再调用的是根store中封装好的`ajax action`，组件中再调用dispach当前页面级`action`实现异步请求